<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                           http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
                           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">


       <!-- controllers -->
       <bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
              <property name="mappings">
                     <props>
                            <prop key="/auth/signup">signUpController</prop>
                            <prop key="/auth/signin">signInController</prop>
                     </props>
              </property>
       </bean>
       <bean id="signUpController" class="com.srt.SpringAuth.controllers.SignUpController">
              <constructor-arg ref="objectMapper" />
              <constructor-arg ref="signUpService" />
              <constructor-arg ref="restControllerUtil" />
       </bean>
       <bean id="signInController" class="com.srt.SpringAuth.controllers.SignInController">
              <constructor-arg ref="restControllerUtil" />
              <constructor-arg ref="objectMapper" />
              <constructor-arg ref="signInService" />
       </bean>

       <!-- utils -->
       <bean id="objectMapper" class="com.fasterxml.jackson.databind.ObjectMapper" />
       <bean id="passwordEncoder" class="com.srt.SpringAuth.utils.PBKDF2PasswordEncoder" />
       <bean id="restControllerUtil" class="com.srt.SpringAuth.utils.RestControllerUtil" />
       <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean" />

       <!-- services -->
       <bean id="signUpService" class="com.srt.SpringAuth.services.SignUpService">
              <constructor-arg ref="authDao" />
              <constructor-arg ref="passwordEncoder" />
       </bean>
       <bean id="signInService" class="com.srt.SpringAuth.services.SignInService">
              <constructor-arg ref="authDao" />
              <constructor-arg ref="passwordEncoder" />
       </bean>

       <!-- data -->
       <bean id="authDao" class="com.srt.SpringAuth.dao.impl.AuthDaoImpl" />

       <!-- entity manager -->
       <tx:annotation-driven transaction-manager="transactionManager" />

       <bean id="entityManagerFactory"
              class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
              <property name="persistenceUnitName" value="my-persistence-unit" />
       </bean>

       <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
              <property name="entityManagerFactory" ref="entityManagerFactory" />
       </bean>

       <context:component-scan base-package="com.srt.SpringAuth" />

</beans>